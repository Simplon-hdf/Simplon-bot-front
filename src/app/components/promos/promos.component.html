<app-add-promo-popup *ngIf="isPopupVisible" (closePopup)="closePopup()"
                     (addPromo)="addPromo($event)">
</app-add-promo-popup>
<section class="w-[1000px] mx-auto">
    <h1 class="font-nunito text-4xl font-semibold mt-20">Promos</h1>
    <div
         class="flex flex-col mt-8 bg-color-white p-8 border border-color-disabled rounded-2xl font-nunito">
        <div class=" overflow-x-auto">
            <div class="min-w-full inline-block align-middle">
                <div class="flex justify-between items-center mb-4">
                    <div class="relative  focus-within:text-gray-900 ">
                        <div
                             class="absolute inset-y-0 left-1 flex items-center pl-3 pointer-events-none ">
                            <svg class="w-5 h-5" viewBox="0 0 20 20" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5 17.5L15.4167 15.4167M15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333C11.0005 15.8333 12.6614 15.0929 13.8667 13.8947C15.0814 12.6872 15.8333 11.0147 15.8333 9.16667Z"
                                      stroke="#9CA3AF" stroke-width="1.6"
                                      stroke-linecap="round" />
                                <path d="M17.5 17.5L15.4167 15.4167M15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333C11.0005 15.8333 12.6614 15.0929 13.8667 13.8947C15.0814 12.6872 15.8333 11.0147 15.8333 9.16667Z"
                                      stroke="black" stroke-opacity="0.2"
                                      stroke-width="1.6"
                                      stroke-linecap="round" />
                                <path d="M17.5 17.5L15.4167 15.4167M15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333C11.0005 15.8333 12.6614 15.0929 13.8667 13.8947C15.0814 12.6872 15.8333 11.0147 15.8333 9.16667Z"
                                      stroke="black" stroke-opacity="0.2"
                                      stroke-width="1.6"
                                      stroke-linecap="round" />
                            </svg>
                        </div>
                        <input type="text" id="default-search"
                               [(ngModel)]="searchTerm" (input)="filterPromos()"
                               class="block pr-5 pl-12 w-80 py-1 text-base font-normal shadow-xs text-gray-900 bg-transparent border border-color-disabled rounded-full placeholder-gray-400 focus:outline-none"
                               placeholder="Rechercher une promo">
                    </div>
                    <button class="font-nunito font-bold text-color-white py-[5px] px-[10px] rounded-md bg-color-red hover:bg-color-red-light"
                            (click)="openPopup()">Ajouter</button>
                </div>
                <div class="overflow-y-scroll max-h-[60vh] ">
                    <table class=" min-w-full rounded-xl">
                        <thead>
                            <tr class="bg-color-select rounded-md sticky top-0">
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize">
                                    Nom </th>
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize">
                                    Lieu </th>
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize">
                                    Cdp </th>
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize">
                                    Date de d√©but </th>
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize ">
                                    Date de fin </th>
                                <th scope="col"
                                    class="p-4 text-left text-nowrap text-sm leading-6 text-gray-900 capitalize ">
                                    Status </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-300 ">
                            <tr class="bg-white transition-all duration-500 hover:bg-color-red hover:bg-opacity-10 hover:cursor-pointer"
                                *ngFor="let promo of filteredPromos"
                                (click)="navigateToPromoDetail(promo.id)">
                                <td
                                    class="p-4 whitespace-nowrap text-wrap text-sm leading-6 font-medium text-gray-900 ">
                                    {{promo.basicInfo.name}} </td>
                                <td
                                    class="p-4 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">
                                    {{promo.basicInfo.place}} </td>
                                <td
                                    class="p-4 whitespace-nowrap text-wrap text-sm leading-6 font-medium text-gray-900 max-w-[200px]">
                                    {{promo.staffs.cdp.name}} </td>
                                <td
                                    class="p-4 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">
                                    {{promo.basicInfo.start_date | date:
                                    'dd/MM/yyyy'}} </td>
                                <td
                                    class="p-4 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">
                                    {{promo.basicInfo.end_date | date:
                                    'dd/MM/yyyy'}} </td>
                                <td
                                    class="p-4 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">
                                    {{promo.basicInfo.status}} </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>